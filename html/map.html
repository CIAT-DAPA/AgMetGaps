<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
  <meta charset="utf-8">
  <title>AgMetGaps</title>
  <link rel='stylesheet' id='divi-fonts-css' href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800&#038;subset=latin,latin-ext'
    type='text/css' media='all' />
  <link rel='stylesheet' id='et-gf-abel-css' href='https://fonts.googleapis.com/css?family=Abel:400&#038;subset=latin' type='text/css'
    media='all' />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <link rel="stylesheet" href="../css/style.css">
  <script type="text/javascript" src="../js/lightStyle.js"></script>



</head>

<body>


  <div class="climate-menu">

    <label>
      <input type="radio" name="radio" value="none" checked/>
      <div class="climate box none">
        <span>CLEAR</span>
      </div>
    </label>

    <label>
      <input type="radio" name="radio" value="precipitation" checked/>
      <div class="climate box">
        <span>Precipitation</span>
      </div>
    </label>

    <label>
      <input type="radio" name="radio" value="temperature" />
      <div class="climate box">
        <span>Temperature</span>
      </div>
    </label>

    <label>
      <input type="radio" name="radio" value="grocprecipitation" />
      <div class="climate box">
        <span>GROC Precipitation</span>
      </div>
    </label>

    <label>
      <input type="radio" name="radio" value="groctemperature" />
      <div class="climate box">
        <span>GROC Temperature</span>
      </div>
    </label>
  </div>

  <div class="crop-menu">

    <label>
      <input type="radio" name="crop" value="none" checked/>
      <div class="none box">
        <span>CLEAR</span>
      </div>
    </label>

    <label>
      <input type="radio" name="crop" value="Maize_cv" />
      <div class="crop box">
        <span>Maize</span>
      </div>
    </label>

    <label>
      <input type="radio" name="crop" value="Rice_cv" />
      <div class="crop box">
        <span>Rice</span>
      </div>
    </label>

    <label>
      <input type="radio" name="crop" value="Wheat_spring_cv" />
      <div class="precipitation box">
        <span>Spring Wheat</span>
      </div>
    </label>

    <label>
      <input type="radio" name="crop" value="Wheat_winter_cv" />
      <div class="crop box">
        <span>Winter wheat</span>
      </div>
    </label>
  </div>


  <div id="time-slider">
    <div id="custom-handle" class="ui-slider-handle"></div>
  </div>
  </div>


  <div id="map"></div>




  <script>

    var month = ["DJF", "JFM", "FMA", "MAM", "AMJ", "MJJ", "JJA", "JAS", "SON", "OND", "NDJ"];

    $(".climate-menu input[type='radio']").click(function () {
      updateMap();
    });

    $(".crop-menu input[type='radio']").click(function () {
      updateMap();
    });


    $(function () {
      var handle = $("#custom-handle");
      $("#time-slider").slider({
        min: 1,
        max: 11,
        value: 1,
        create: function () {
          handle.text(month[$(this).slider("value") - 1]);
        },
        slide: function (event, ui) {
          handle.text(month[ui.value - 1]);
          refreshMap($("input[name='radio']:checked").val(), month[ui.value - 1]);
        }

      });
    });


    var climateOverlay;
    var cropOverlay;
    var mapZoom = 3;
    var mapCenter = { lat: 0, lng: 0 };
    var mapTypeSelected = 'lightStyledMapType';
    var mapImageBounds = {
      north: 90,
      south: -90,
      east: 180,
      west: -180
    };



    function initMap() {
      refreshMap("precipitation", month[0], "none");
    }

    function updateMap() {
      refreshMap($(".climate-menu input[type='radio']:checked").val(), month[$("#time-slider").slider("value") - 1], $(".crop-menu input[type='radio']:checked").val());
    }

    function refreshMap(climateVar, season, crop) {
      var map = new google.maps.Map(document.getElementById('map'), {
        zoom: mapZoom,
        center: mapCenter,
        mapTypeControlOptions: {
          mapTypeIds: ['roadmap', 'satellite', 'hybrid', 'terrain', 'lightStyledMapType']
        }
      });

      var lightStyledMapType = new google.maps.StyledMapType(lightStyle, { name: 'White' });

      //Associate the styled map with the MapTypeId and set it to display.
      map.mapTypes.set('lightStyledMapType', lightStyledMapType);
      map.setMapTypeId(mapTypeSelected);

      //Set local storage variables.
      mapCenter = map.getCenter();
      mapZoom = map.getZoom();

      google.maps.event.addListener(map, "center_changed", function () {
        //Set local storage variables.
        mapCenter = map.getCenter();
        mapZoom = map.getZoom();
      });

      google.maps.event.addListener(map, "zoom_changed", function () {
        //Set local storage variables.
        mapCenter = map.getCenter();
        mapZoom = map.getZoom();
      });

      google.maps.event.addListener(map, "maptypeid_changed", function () {
        //Set local storage variables.
        mapTypeSelected = map.getMapTypeId();
      });

      if (climateVar != 'none') {
        climateOverlay = new google.maps.GroundOverlay(
          "../img/" + climateVar + '/' + season + '.png',
          mapImageBounds);
        climateOverlay.setOpacity(0.7);
        climateOverlay.setMap(map);
      }

      if (crop != 'none') {
        cropOverlay = new google.maps.GroundOverlay(
          "../img/" + 'yield' + '/' + crop + '.png',
          mapImageBounds);
        cropOverlay.setOpacity(0.7);
        cropOverlay.setMap(map);
      }

      // Create the legend and display on the map
      var legend = document.createElement('div');
      legend.id = 'ts-map-legend';


      //assemble html and place in var
      var content = [];
      if (climateVar == 'precipitation') {
        content.push('<h3 class="ts-map-legend-headline">Precipitation</h3>');
        content.push('<p><div class="ts-map-legend-color ts-map-legend-color-precipitation1"></div>' + '&lt; 0.33' + '</p>');
        content.push('<p><div class="ts-map-legend-color ts-map-legend-color-precipitation2"></div>' + '0.33, 0.66' + '</p>');
        content.push('<p><div class="ts-map-legend-color ts-map-legend-color-precipitation3"></div>' + '&gt; 0.66' + '</p>');
      }
      if (crop != 'none') {
        content.push('<h3 class="ts-map-legend-headline">Yield</h3>');
        content.push('<p><div class="ts-map-legend-color ts-map-legend-color-yield1"></div>' + '&lt; 0.33' + '</p>');
        content.push('<p><div class="ts-map-legend-color ts-map-legend-color-yield2"></div>' + '0.33, 0.66' + '</p>');
        content.push('<p><div class="ts-map-legend-color ts-map-legend-color-yield3"></div>' + '&gt; 0.66' + '</p>');
      }

      legend.innerHTML = content.join('');
      legend.index = 1;
      map.controls[google.maps.ControlPosition.RIGHT_TOP].push(legend);





    }
  </script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDzJRiWK2Iz5Ghwe7Qk-g4FDFxotEOQXtM&callback=initMap"
  />
  <script src="https://maps.googleapis.com/maps/api/staticmap?key=AIzaSyDzJRiWK2Iz5Ghwe7Qk-g4FDFxotEOQXtM&center=21.61520658671325,91.99239959716793&zoom=5&format=png&maptype=roadmap&style=element:geometry%7Ccolor:0x212121&style=element:labels.icon%7Cvisibility:off&style=element:labels.text.fill%7Ccolor:0x757575&style=element:labels.text.stroke%7Ccolor:0x212121&style=feature:administrative%7Celement:geometry%7Ccolor:0x757575&style=feature:administrative.country%7Celement:geometry.stroke%7Cvisibility:on&style=feature:administrative.country%7Celement:labels.text.fill%7Ccolor:0x9e9e9e&style=feature:administrative.land_parcel%7Cvisibility:off&style=feature:administrative.locality%7Celement:labels.text.fill%7Ccolor:0xbdbdbd%7Cvisibility:off&style=feature:landscape%7Cvisibility:on&style=feature:poi%7Celement:labels.text.fill%7Ccolor:0x757575&style=feature:poi.park%7Celement:geometry%7Ccolor:0x181818&style=feature:poi.park%7Celement:geometry.stroke%7Cvisibility:on&style=feature:poi.park%7Celement:labels.text.fill%7Ccolor:0x616161&style=feature:poi.park%7Celement:labels.text.stroke%7Ccolor:0x1b1b1b&style=feature:road%7Celement:geometry.fill%7Ccolor:0x2c2c2c&style=feature:road%7Celement:labels.text.fill%7Ccolor:0x8a8a8a&style=feature:road.arterial%7Cvisibility:off&style=feature:road.arterial%7Celement:geometry%7Ccolor:0x373737&style=feature:road.highway%7Celement:geometry%7Ccolor:0x3c3c3c&style=feature:road.highway%7Celement:labels%7Cvisibility:off&style=feature:road.highway.controlled_access%7Celement:geometry%7Ccolor:0x4e4e4e&style=feature:road.local%7Cvisibility:off&style=feature:road.local%7Celement:labels.text.fill%7Ccolor:0x616161&style=feature:transit%7Celement:labels.text.fill%7Ccolor:0x757575&style=feature:water%7Celement:geometry%7Ccolor:0x000000&style=feature:water%7Celement:geometry.stroke%7Cvisibility:on&style=feature:water%7Celement:labels.text.fill%7Ccolor:0x3d3d3d&size=480x360"
  />



  </script>
</body>

</html>